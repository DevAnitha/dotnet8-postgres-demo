create table if not exists one_stop_checklist_statuses (
    one_stop_checklist_status_id int generated by default as identity primary key,
    one_stop_checklist_status_code text not null,
    one_stop_checklist_status_name text not null,
    sort_order int,
    record_status_id int,

    created_by int,
    created_date timestamp not null default now(),
    created_machine text,
    modified_by int,
    modified_date timestamp,
    modified_machine text,
    deleted_by int,
    deleted_date timestamp,
    deleted_machine text
);


create table if not exists one_stop_offices (
    one_stop_office_id int generated by default as identity primary key,
    one_stop_office_name text not null,
    sort_order int,
    record_status_id int,

    created_by int,
    created_date timestamp not null default now(),
    created_machine text,
    modified_by int,
    modified_date timestamp,
    modified_machine text,
    deleted_by int,
    deleted_date timestamp,
    deleted_machine text
);

create table if not exists one_stop_office_items (
    one_stop_office_item_id int generated by default as identity primary key,
    one_stop_office_id int not null,
    one_stop_office_item_name text not null,
    control_type text not null,
    sort_order int,
    record_status_id int,

    created_by int,
    created_date timestamp not null default now(),
    created_machine text,
    modified_by int,
    modified_date timestamp,
    modified_machine text,
    deleted_by int,
    deleted_date timestamp,
    deleted_machine text,

    constraint fk_one_stop_office_items_office
        foreign key (one_stop_office_id) references one_stop_offices(one_stop_office_id)
);


create table if not exists separation_initiation (
    separation_initiation_id int generated by default as identity primary key,
    core_identity_id int not null,          -- FK target owned by other team (add later if confirmed)
    last_day date,
    separation_date date,
    separation_type_id int not null,
    reason_for_separation text,
    supervisor_id int,                      -- FK target owned by other team (add later if confirmed)
    is_notify_employee boolean,
    additional_notes text,
    separation_status_id int not null,
    record_status_id int,

    created_by int,
    created_date timestamp not null default now(),
    created_machine text,
    modified_by int,
    modified_date timestamp,
    modified_machine text,
    deleted_by int,
    deleted_date timestamp,
    deleted_machine text,

    constraint fk_separation_initiation_type
        foreign key (separation_type_id) references separation_type(separation_type_id),

    constraint fk_separation_initiation_status
        foreign key (separation_status_id) references separation_status(separation_status_id)
);


create table if not exists one_stop_office_separation_checklist (
    one_stop_office_separation_checklist_id int generated by default as identity primary key,
    separation_initiation_id int not null,
    one_stop_office_id int not null,
    one_stop_office_item_id int not null,
    one_stop_checklist_status_id int not null,
    checklist_answer_text text,
    validation_notes text,
    completed_by int,
    completed_date timestamp,
    validated_by int,
    validated_date timestamp,
    record_status_id int,

    created_by int,
    created_date timestamp not null default now(),
    created_machine text,
    modified_by int,
    modified_date timestamp,
    modified_machine text,
    deleted_by int,
    deleted_date timestamp,
    deleted_machine text,

    constraint fk_os_checklist_separation_initiation
        foreign key (separation_initiation_id) references separation_initiation(separation_initiation_id),

    constraint fk_os_checklist_office
        foreign key (one_stop_office_id) references one_stop_offices(one_stop_office_id),

    constraint fk_os_checklist_office_item
        foreign key (one_stop_office_item_id) references one_stop_office_items(one_stop_office_item_id),

    constraint fk_os_checklist_status
        foreign key (one_stop_checklist_status_id) references one_stop_checklist_statuses(one_stop_checklist_status_id)
);



-- alter table separation_initiation
-- add constraint fk_separation_initiation_core_identity
-- foreign key (core_identity_id) references core_identity(core_identity_id);

-- alter table separation_initiation
-- add constraint fk_separation_initiation_supervisor
-- foreign key (supervisor_id) references core_identity(core_identity_id);